webpackJsonp([28],{"7JUg":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("HzJ8"),l=a.n(i),s=a("hKuw"),o=a("4T3X"),n=a("YgaF"),d=[{code:"idMine",name:"矿场中文名",up:!0},{code:"noRoom",name:"机房号",up:!0},{code:"statusReady",name:"可用状态",up:!0},{code:"statusUse",name:"使用状态",up:!0},{code:"maRoomShelfVersionRelVOList",name:"货架规格及数量",up:!0}],r={data:function(){return{list:{query:{},data:[],loading:!1},pageNo:1,totalCount:0,pageSize:10,dialog:{loading:!1,visible:!1,title:{c:"新增机房信息",u:"修改机房信息",v:"机房详情信息"},btn:{c:"新增",u:"修改",v:"关闭"},status:["c","u","v"],data:{}},dict:{mines:{list:[],obj:{}},statusRd:{list:[],obj:{}},statusUs:{list:[],obj:{}},rooms:{list:[],obj:{}},shelfVns:{list:[],obj:{}}},item:{}}},created:function(){this.initDict(),this.fetchData()},methods:{fetchData:function(){this.pageNo=1,this.search()},handleSizeChange:function(t){this.pageSize=t,this.fetchData()},showDialog:function(t,e){this.dialog.status=t,this.dialog.visible=!0,"c"===t?this.dialog.data={maRoomShelfVersionRelVOList:[{idShelfVersion:void 0,numShelf:void 0,nameShelfVersion:void 0}],idMine:void 0,noRoom:void 0,statusReady:void 0,statusUse:void 0}:(this.dialog.data={},this.detail(e.id))},detail:function(t){var e=this;this.dialog.loading=!0,s.a.find(t).then(function(t){e.dialog.data=t.result,e.dialog.loading=!1}).catch(function(t){e.dialog.loading=!1})},check:function(){var t=!0,e=!0,a=!1,i=void 0;try{for(var s,o=l()(d);!(e=(s=o.next()).done);e=!0){var n=s.value,r=this.dialog.data[n.code];if("maRoomShelfVersionRelVOList"===n.code){var c=!0,u=!1,f=void 0;try{for(var m,h=l()(r);!(c=(m=h.next()).done);c=!0){var g=m.value;if(b(g.idShelfVersion)||b(g.numShelf)){var v=n.name+"不能为空！";return this.$message.error(v),t=!1,!1}g.nameShelfVersion=this.dict.shelfVns.obj[g.idShelfVersion]}}catch(t){u=!0,f=t}finally{try{!c&&h.return&&h.return()}finally{if(u)throw f}}if(!t)return!1}else if(b(r)){var p=n.name+"不能为空！";return this.$message.error(p),t=!1,!1}}}catch(t){a=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw i}}function b(t){return void 0===t||null===t||""===t.toString().trim()}return t},submit:function(){var t=this;if(this.dialog.loading=!0,this.check())if("c"===this.dialog.status)s.a.create(this.dialog.data).then(function(e){t.submitSuccess()}).catch(function(e){t.dialog.loading=!1});else if("u"===this.dialog.status){var e={id:this.dialog.data.id},a=!0,i=!1,o=void 0;try{for(var n,r=l()(d);!(a=(n=r.next()).done);a=!0){var c=n.value;c.up&&(e[c.code]=this.dialog.data[c.code])}}catch(t){i=!0,o=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw o}}e.remark=this.dialog.data.remark||"",s.a.update(e).then(function(e){t.submitSuccess()}).catch(function(e){t.dialog.loading=!1})}else this.dialog.loading=!1;else this.dialog.loading=!1},submitSuccess:function(){this.$message({message:this.dialog.title[this.dialog.status]+"成功",type:"success"}),this.dialog.loading=!1,this.cancel(),this.fetchData()},cancel:function(){this.dialog.visible=!1},currentChange:function(t){this.pageNo=t,this.search()},search:function(){var t=this;this.list.loading=!0,this.list.query.pageNo=this.pageNo,this.list.query.pageSize=this.pageSize,s.a.findAll(this.list.query).then(function(e){t.handShelfVn(e.result.recordList),t.totalCount=e.result.totalRecord,t.list.loading=!1}).catch(function(e){t.list.loading=!1})},handShelfVn:function(t){t?(t.forEach(function(t){var e=t.maRoomShelfVersionRelVOList;if(e){var a=[];e.forEach(function(t){a.push(t.nameShelfVersion+":"+t.numShelf)}),t.maRoomShelfVersionRels=a.join("|")}}),this.list.data=t):this.list.data=[]},initDict:function(){Object(o.a)("local_1").then(function(t){this.dict.statusRd=t}.bind(this)),Object(o.a)("local_2").then(function(t){this.dict.statusUs=t}.bind(this)),Object(o.a)("local_3").then(function(t){this.dict.rooms=t}.bind(this)),n.a.getMineList().then(function(t){this.dict.mines=t}.bind(this)),n.a.getShelfList().then(function(t){this.dict.shelfVns=t}.bind(this))},optNumShelf:function(t,e){0===t?this.dialog.data.maRoomShelfVersionRelVOList.push({idShelfVersion:void 0,numShelf:void 0,nameShelfVersion:void 0}):1===t?this.dialog.data.maRoomShelfVersionRelVOList.remove(e):console.log("error option")}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container calendar-list-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.list.query}},[a("el-form-item",{attrs:{label:"矿场中文名"}},[a("el-select",{attrs:{clearable:"",placeholder:"全部"},model:{value:t.list.query.idMine,callback:function(e){t.$set(t.list.query,"idMine",e)},expression:"list.query.idMine"}},t._l(t.dict.mines.list,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"可用状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"全部"},model:{value:t.list.query.statusReady,callback:function(e){t.$set(t.list.query,"statusReady",e)},expression:"list.query.statusReady"}},t._l(t.dict.statusRd.list,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"使用状态"}},[a("el-select",{attrs:{clearable:"",placeholder:"全部"},model:{value:t.list.query.statusUse,callback:function(e){t.$set(t.list.query,"statusUse",e)},expression:"list.query.statusUse"}},t._l(t.dict.statusUs.list,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.fetchData}},[t._v("查询")]),t._v(" "),t.btn.add?a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(e){t.showDialog("c")}}},[t._v(t._s(t.btn.add))]):t._e()],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.list.loading,expression:"list.loading",modifiers:{body:!0}}],attrs:{stripe:"",data:t.list.data,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"矿场中文名",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.dict.mines.obj[e.row.idMine]))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"机房号",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.dict.rooms.obj[e.row.noRoom]))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"货架规格及数量",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.maRoomShelfVersionRels))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"可用状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.dict.statusRd.obj[e.row.statusReady]))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"使用状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.dict.statusUs.obj[e.row.statusUse]))]}}])}),t._v(" "),a("el-table-column",{staticStyle:{"white-space":"nowrap"},attrs:{align:"center",label:"操作","class-name":"mid-padding fixed-width",width:"230"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.btn.edit?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.showDialog("u",e.row)}}},[t._v(t._s(t.btn.edit))]):t._e(),t._v(" "),t.btn.info?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){t.showDialog("v",e.row)}}},[t._v(t._s(t.btn.info))]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container",staticStyle:{"margin-top":"20px","text-align":"left"}},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,20,30,40,50,60,70,80,90,100],"current-page":t.pageNo,total:t.totalCount,"page-size":t.pageSize},on:{"size-change":t.handleSizeChange,"current-change":t.currentChange}})],1),t._v(" "),a("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,title:t.dialog.title[t.dialog.status],visible:t.dialog.visible,width:"800px"},on:{"update:visible":function(e){t.$set(t.dialog,"visible",e)}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.dialog.loading,expression:"dialog.loading"}],attrs:{model:t.dialog.data,"label-width":"110px"}},[a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"矿场中文名",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:"v"===t.dialog.status},model:{value:t.dialog.data.idMine,callback:function(e){t.$set(t.dialog.data,"idMine",e)},expression:"dialog.data.idMine"}},t._l(t.dict.mines.list,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"机房号",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:"c"!==t.dialog.status},model:{value:t.dialog.data.noRoom,callback:function(e){t.$set(t.dialog.data,"noRoom",e)},expression:"dialog.data.noRoom"}},t._l(t.dict.rooms.list,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)],1)]),t._v(" "),t._l(t.dialog.data.maRoomShelfVersionRelVOList,function(e,i){return a("el-row",{key:e.key},[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"货架规格",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:"v"===t.dialog.status},model:{value:e.idShelfVersion,callback:function(a){t.$set(e,"idShelfVersion",a)},expression:"item.idShelfVersion"}},t._l(t.dict.shelfVns.list,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("div",{staticClass:"el-col el-col-11"},[a("el-form-item",{attrs:{label:"货架安置数量",required:""}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1,max:999,disabled:"v"===t.dialog.status},model:{value:e.numShelf,callback:function(a){t.$set(e,"numShelf",a)},expression:"item.numShelf"}})],1)],1),t._v(" "),"v"!==t.dialog.status?a("div",{staticClass:"el-col el-col-1 el-add"},[0===i?a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.optNumShelf(0)}}}):t._e(),t._v(" "),0!==i?a("i",{staticClass:"el-icon-remove",on:{click:function(e){t.optNumShelf(1,i)}}}):t._e()]):t._e()])}),t._v(" "),a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"可用状态",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:"v"===t.dialog.status},model:{value:t.dialog.data.statusReady,callback:function(e){t.$set(t.dialog.data,"statusReady",e)},expression:"dialog.data.statusReady"}},t._l(t.dict.statusRd.list,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"使用状态",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:"v"===t.dialog.status},model:{value:t.dialog.data.statusUse,callback:function(e){t.$set(t.dialog.data,"statusUse",e)},expression:"dialog.data.statusUse"}},t._l(t.dict.statusUs.list,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)],1)]),t._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{rows:"4",type:"textarea",maxlength:"200",disabled:"v"===t.dialog.status},model:{value:t.dialog.data.remark,callback:function(e){t.$set(t.dialog.data,"remark",e)},expression:"dialog.data.remark"}})],1)],1),t._v(" "),"c"!==t.dialog.status?a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"创建人"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.dialog.data.nameCreator,callback:function(e){t.$set(t.dialog.data,"nameCreator",e)},expression:"dialog.data.nameCreator"}})],1)],1),t._v(" "),a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",disabled:!0},model:{value:t.dialog.data.timeCreate,callback:function(e){t.$set(t.dialog.data,"timeCreate",e)},expression:"dialog.data.timeCreate"}})],1)],1)]):t._e(),t._v(" "),"v"===t.dialog.status?a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"修改人"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.dialog.data.nameUpdater,callback:function(e){t.$set(t.dialog.data,"nameUpdater",e)},expression:"dialog.data.nameUpdater"}})],1)],1),t._v(" "),a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"修改时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",disabled:!0},model:{value:t.dialog.data.timeUpdate,callback:function(e){t.$set(t.dialog.data,"timeUpdate",e)},expression:"dialog.data.timeUpdate"}})],1)],1)]):t._e(),t._v(" "),a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",["v"!==t.dialog.status?a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(t._s(t.dialog.btn[t.dialog.status]))]):t._e(),t._v(" "),a("el-button",{on:{click:t.cancel}},[t._v(t._s("v"===t.dialog.status?t.dialog.btn[t.dialog.status]:"取消"))])],1)],1)])],2)],1)],1)},staticRenderFns:[]};var u=a("/Xao")(r,c,!1,function(t){a("IEc3")},"data-v-0b97e83d",null);e.default=u.exports},IEc3:function(t,e,a){var i=a("kM7E");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("8bSs")("571929cc",i,!0)},kM7E:function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,"\n.el-add[data-v-0b97e83d] {\n  text-align: right;\n  font-size: 24px;\n  height: 40px;\n  line-height: 40px;\n  color: #409eff;\n}\n",""])}});