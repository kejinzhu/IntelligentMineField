webpackJsonp([8],{"0TK5":function(e,t,a){"use strict";var i=a("vLgD");t.a={getList:function(e){return Object(i.a)({url:"/menus",method:"get",params:e})},add:function(e){return Object(i.a)({url:"/menus",method:"post",data:e})},get:function(e){return Object(i.a)({url:"/menus/"+e,method:"get"})},patch:function(e){return Object(i.a)({url:"/menus/"+e.id,method:"put",data:e})}}},"2qRd":function(e,t,a){var i=a("Kz1K");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("8bSs")("aab83968",i,!0)},Kz1K:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,'\ninput[data-v-57d1a46c]::-webkit-outer-spin-button,\ninput[data-v-57d1a46c]::-webkit-inner-spin-button {\n  -webkit-appearance: none !important;\n  margin: 0;\n}\ninput[type="number"][data-v-57d1a46c] {\n  -moz-appearance: textfield;\n  line-height: 0;\n}\n',""])},tiUO:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("ZLEe"),n=a.n(i),r=a("+NE1"),d=(a("4T3X"),a("0TK5")),o=a("RbaZ"),l={name:"角色名"},s={data:function(){return{addVisible:!1,addType:1,list:[],listLoading:!0,addLoading:!1,totalCount:0,pageNo:1,pageSize:10,formInline:{name:""},addForm:{id:"",name:"",idMenus:[],remark:"",nameUpdater:"",timeUpdate:"",nameCreator:"",timeCreate:""},data:[],defaultProps:{children:"children",label:"name"},listObj:{}}},filters:{},created:function(){this.fetchData()},mounted:function(){},computed:{addTitle:function(){return 1===this.addType?"新增角色信息":2===this.addType?"修改角色信息":3===this.addType?"角色详细信息":void 0},btnName:function(){return 2===this.addType?"修改":"新增"}},methods:{getMenu:function(){var e=this;this.addLoading=!0;d.a.getList({pageSize:0,pageNo:0}).then(function(t){var a,i;3===e.addType?e.data=o.a.initTree(t.result.recordList,!0):e.data=o.a.initTree(t.result.recordList),e.listObj=(a=t.result.recordList,i={},a.forEach(function(e){i[e.id]=e.idParent}),i),e.addLoading=!1})},checkChange:function(e,t){var a=this;t?function e(t,i){var n=a.listObj[t];0!==n&&(a.$refs.tree.setChecked(n,i),e(n,i))}(e.id,t):function e(t,i){var n=t.children;n&&n.length>0&&n.forEach(function(t){a.$refs.tree.setChecked(t.id,i),t.children&&t.children.length>0&&e(t,i)})}(e,t)},searchList:function(){this.pageNo=1,this.fetchData()},fetchData:function(){var e=this,t={pageSize:this.pageSize,pageNo:this.pageNo};this.formInline.name&&(t.name=this.formInline.name),this.listLoading=!0,r.a.getList(t).then(function(t){e.list=t.result.recordList,e.totalCount=t.result.totalRecord,e.listLoading=!1})},handleSizeChange:function(e){this.pageNo=1,this.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.pageNo=e,this.fetchData()},clickBtn:function(e,t){var a=this;this.addType=e,this.getMenu(),1===e?(a.addLoading=!1,n()(a.addForm).forEach(function(e){a.addForm[e]=""})):this.getInfo(t),this.addVisible=!0},getInfo:function(e){var t=this,a=this;this.addLoading=!0,r.a.get(e).then(function(e){var i;i=e.result,n()(a.addForm).forEach(function(e){a.addForm[e]=i[e]}),t.setCheckedKeys(e.result.idMenus),t.addLoading=!1})},setCheckedKeys:function(e){e&&this.$refs.tree.setCheckedKeys(e)},getCheckedKeys:function(){this.addForm.idMenus=this.$refs.tree.getCheckedKeys()},valid:function(){for(var e in l){if(""===this.addForm[e].toString().trim()){var t=l[e]+"不能为空！";return this.$message.error(t),!1}}if(this.addForm.idMenus.length<1){return this.$message.error("功能权限不能为空！"),!1}return!0},addSubmit:function(){if(this.getCheckedKeys(),this.valid()){var e=this,t="";this.addLoading=!0,1===this.addType?(t="添加成功！",r.a.add(this.addForm).then(function(e){a()},function(e){i()})):2===this.addType&&(t="修改成功！",r.a.patch(this.addForm).then(function(e){a()},function(e){i()}))}function a(){e.$message({message:t,type:"success"}),e.addVisible=!1,e.addLoading=!1,e.fetchData()}function i(){e.addLoading=!1}},addCancel:function(){this.addVisible=!1}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container calendar-list-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"角色名"}},[a("el-input",{attrs:{clearable:""},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchList}},[e._v("查询")]),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.clickBtn(1)}}},[e._v("新增")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",stripe:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"角色名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.nameCreator))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("parseTime")(t.row.timeCreate,"{y}-{m}-{d} {h}:{i}:{s}")))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"修改人",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.nameUpdater))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.timeUpdate?[e._v(e._s(e._f("parseTime")(t.row.timeUpdate,"{y}-{m}-{d} {h}:{i}:{s}")))]:void 0}}])}),e._v(" "),a("el-table-column",{staticStyle:{"white-space":"nowrap"},attrs:{align:"center",label:"操作","class-name":"mid-padding fixed-width",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.clickBtn(2,t.row.id)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){e.clickBtn(3,t.row.id)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,20,30,40,50,60,70,80,90,100],"current-page":e.pageNo,total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,title:e.addTitle,visible:e.addVisible,width:"800px"},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.addLoading,expression:"addLoading"}],ref:"form",attrs:{model:e.addForm,"label-width":"100px"}},[a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"角色名",required:""}},[a("el-input",{attrs:{disabled:3===e.addType,onKeypress:"return (!/^\\s*$/.test(String.fromCharCode(event.which)))"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1)],1)]),e._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"功能权限",required:""}},[a("div",{staticStyle:{"max-height":"400px","overflow-y":"auto","margin-top":"10px"}},[a("el-tree",{ref:"tree",attrs:{data:e.data,"show-checkbox":"","check-strictly":!0,"node-key":"id","default-expand-all":!0,props:e.defaultProps},on:{"check-change":e.checkChange}})],1)])],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",disabled:3===e.addType,rows:4,maxlength:"200"},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1),e._v(" "),1!==e.addType?a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"创建人"}},[a("el-input",{attrs:{disabled:""},model:{value:e.addForm.nameCreator,callback:function(t){e.$set(e.addForm,"nameCreator",t)},expression:"addForm.nameCreator"}})],1)],1),e._v(" "),a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",disabled:""},model:{value:e.addForm.timeCreate,callback:function(t){e.$set(e.addForm,"timeCreate",t)},expression:"addForm.timeCreate"}})],1)],1)]):e._e(),e._v(" "),3===e.addType?a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"修改人"}},[a("el-input",{attrs:{disabled:""},model:{value:e.addForm.nameUpdater,callback:function(t){e.$set(e.addForm,"nameUpdater",t)},expression:"addForm.nameUpdater"}})],1)],1),e._v(" "),a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"修改时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",disabled:""},model:{value:e.addForm.timeUpdate,callback:function(t){e.$set(e.addForm,"timeUpdate",t)},expression:"addForm.timeUpdate"}})],1)],1)]):e._e(),e._v(" "),a("el-form-item",[3!==e.addType?a("el-button",{attrs:{type:"primary"},on:{click:e.addSubmit}},[e._v(e._s(e.btnName))]):e._e(),e._v(" "),3!==e.addType?a("el-button",{on:{click:e.addCancel}},[e._v("取消")]):e._e(),e._v(" "),3===e.addType?a("el-button",{on:{click:e.addCancel}},[e._v("关闭")]):e._e()],1)],1)],1)],1)},staticRenderFns:[]};var u=a("/Xao")(s,c,!1,function(e){a("2qRd")},"data-v-57d1a46c",null);t.default=u.exports}});