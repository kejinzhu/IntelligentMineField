webpackJsonp([23],{OsqV:function(e,t,a){var i=a("XLAO");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("8bSs")("be2fb470",i,!0)},XLAO:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,'\n.el-add[data-v-3502d213] {\n  text-align: center;\n  font-size: 24px;\n  height: 40px;\n  line-height: 40px;\n  color: #409EFF;\n}\ninput[data-v-3502d213]::-webkit-outer-spin-button,\ninput[data-v-3502d213]::-webkit-inner-spin-button {\n  -webkit-appearance: none !important;\n  margin: 0;\n}\ninput[type="number"][data-v-3502d213] {\n  -moz-appearance: textfield;\n  line-height: 0;\n}\n',""])},q5o8:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("aA9S"),n=a.n(i),l=a("ZLEe"),r=a.n(l),s=a("RLgv"),o=a("EsgS"),d=a("4T3X"),c={code:"货架规格"},m={data:function(){return{addVisible:!1,addType:1,list:[],listLoading:!0,addLoading:!1,totalCount:0,pageNo:1,pageSize:10,formInline:{name:""},addForm:{id:"",name:"",code:"",remark:"",relList:[],nameUpdater:"",timeUpdate:"",nameCreator:"",timeCreate:"",status:0},itemForm:{idMachineVersion:"",nameMachineVersion:"",numMachine:void 0,status:0},dicts:{shelfSpec:{list:[],obj:{}}},shelfList:[]}},filters:{},created:function(){this.getDict(),this.fetchData(),this.getMachine()},computed:{addTitle:function(){return 1===this.addType?"新增货架规格信息":2===this.addType?"修改货架规格信息":3===this.addType?"货架规格详细信息":void 0},btnName:function(){return 2===this.addType?"修改":"新增"}},methods:{codeInput:function(e){this.addForm.name=e.target.value},nameInput:function(e){for(var t=0;t<this.shelfList.length;t++)if(e==this.shelfList[t].id)return this.shelfList[t].name;return"无"},nameTransform:function(e){var t=this;e.forEach(function(e){e.nameMachineVersion=t.nameInput(e.idMachineVersion)})},getDict:function(){Object(d.a)("dict_13").then(function(e){this.dicts.shelfSpec=e}.bind(this))},getMachine:function(){var e=this,t={pageSize:0,pageNo:this.pageNo};o.a.getList(t).then(function(t){e.shelfList=t.result.recordList})},searchList:function(){this.pageNo=1,this.fetchData()},fetchData:function(){var e=this,t={pageSize:this.pageSize,pageNo:this.pageNo};this.formInline.name&&(t.name=this.formInline.name),this.listLoading=!0,s.a.getList(t).then(function(t){e.list=t.result.recordList,e.transformRel(),e.totalCount=t.result.totalRecord,e.listLoading=!1})},dictTransform:function(e,t){for(var a=this.dict[e],i=0;i<a.length;i++)if(t==a[i].key)return a[i].value},handleSizeChange:function(e){this.pageNo=1,this.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.pageNo=e,this.fetchData()},transformRel:function(){void 0!==this.list&&null!==this.list&&this.list.forEach(function(e){var t,a,i;e.relList&&e.relList.length>0&&(e.rel=(t=e.relList,a="",i="",t.forEach(function(e,t){a&&(i=" | "),a=""+a+i+e.nameMachineVersion+":"+e.numMachine+" "}),a))})},clickBtn:function(e,t){var a=this;this.addType=e,1===e?(a.addLoading=!1,r()(a.addForm).forEach(function(e){"status"===e||("relList"===e?a.addForm.relList=[n()({},a.itemForm)]:a.addForm[e]="")})):this.getInfo(t),this.addVisible=!0},getInfo:function(e){var t=this,a=this;this.addLoading=!0,s.a.get(e).then(function(e){var i;i=e.result,r()(a.addForm).forEach(function(e){a.addForm[e]="code"===e?parseInt(i[e]):i[e]}),t.addLoading=!1})},addItem:function(){this.addForm.relList.push(n()({},this.itemForm))},reduceItem:function(e){this.addForm.relList.remove(e)},valid:function(){for(var e in c){var t=this.addForm[e];if(void 0===t||null===t||""===t){var a=c[e]+"不能为空！";return this.$message.error(a),!1}}return!0},validRel:function(e){for(var t=0;t<e.length;t++){if(void 0===e[t].idMachineVersion||null===e[t].idMachineVersion||""===e[t].idMachineVersion)return this.$message.error("可放置型号不能为空"),!1;if(void 0===e[t].numMachine||null===e[t].numMachine||""===e[t].numMachine)return this.$message.error("可放置数量不能为空"),!1;if(e[t].numMachine<=0)return this.$message.error("可放置数量不能小于等于零"),!1;if(e[t].numMachine>255)return this.$message.error("可放置数量不能大于255"),!1}return!0},addSubmit:function(){if(this.valid()&&this.validRel(this.addForm.relList)){var e=this,t="";this.addLoading=!0,this.nameTransform(this.addForm.relList),1===this.addType?(t="添加成功！",s.a.add(this.addForm).then(function(e){a()})):2===this.addType&&(t="修改成功！",s.a.patch(this.addForm).then(function(e){a()}))}function a(){e.$message({message:t,type:"success"}),e.addVisible=!1,e.addLoading=!1,e.fetchData()}},addCancel:function(){this.addVisible=!1}},watch:{}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container calendar-list-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"货架规格"}},[a("el-select",{attrs:{clearable:"",placeholder:"全部"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}},e._l(e.dicts.shelfSpec.list,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchList}},[e._v("查询")]),e._v(" "),e.btn.add?a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.clickBtn(1)}}},[e._v(e._s(e.btn.add))]):e._e()],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",stripe:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"货架规格ID",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.id))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"货架规格",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"可放置型号及数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.rel))]}}])}),e._v(" "),a("el-table-column",{staticStyle:{"white-space":"nowrap"},attrs:{align:"center",label:"操作","class-name":"mid-padding fixed-width",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.btn.edit?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.clickBtn(2,t.row.id)}}},[e._v(e._s(e.btn.edit))]):e._e(),e._v(" "),e.btn.info?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){e.clickBtn(3,t.row.id)}}},[e._v(e._s(e.btn.info))]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,20,30,40,50,60,70,80,90,100],"current-page":e.pageNo,total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,title:e.addTitle,visible:e.addVisible,width:"800px"},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.addLoading,expression:"addLoading"}],ref:"form",attrs:{model:e.addForm,"label-width":"100px"}},[a("el-row",[a("div",{staticClass:"el-col el-col-24"},[a("el-form-item",{attrs:{label:"货架规格",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:3===e.addType},on:{blur:e.codeInput},model:{value:e.addForm.code,callback:function(t){e.$set(e.addForm,"code",t)},expression:"addForm.code"}},e._l(e.dicts.shelfSpec.list,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1)]),e._v(" "),e._l(e.addForm.relList,function(t,i){return a("el-row",{key:t.key},[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"可放置型号",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",disabled:3===e.addType},model:{value:t.idMachineVersion,callback:function(a){e.$set(t,"idMachineVersion",a)},expression:"item.idMachineVersion"}},e._l(e.shelfList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("div",{staticClass:"el-col el-col-10"},[a("el-form-item",{attrs:{label:"可放置数量",required:""}},[a("el-input-number",{attrs:{"controls-position":"right",disabled:3===e.addType,maxlength:"3"},model:{value:t.numMachine,callback:function(a){e.$set(t,"numMachine",a)},expression:"item.numMachine"}})],1)],1),e._v(" "),a("div",{staticClass:"el-col el-col-2 el-add"},[0===i&&3!==e.addType?a("i",{staticClass:"el-icon-circle-plus",on:{click:e.addItem}}):e._e(),e._v(" "),0!==i&&3!==e.addType?a("i",{staticClass:"el-icon-remove",on:{click:function(t){e.reduceItem(i)}}}):e._e()])])}),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",disabled:3===e.addType,maxlength:"200",rows:4},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1),e._v(" "),1!==e.addType?a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"创建人"}},[a("el-input",{attrs:{disabled:""},model:{value:e.addForm.nameCreator,callback:function(t){e.$set(e.addForm,"nameCreator",t)},expression:"addForm.nameCreator"}})],1)],1),e._v(" "),a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",disabled:""},model:{value:e.addForm.timeCreate,callback:function(t){e.$set(e.addForm,"timeCreate",t)},expression:"addForm.timeCreate"}})],1)],1)]):e._e(),e._v(" "),3===e.addType?a("el-row",[a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"修改人"}},[a("el-input",{attrs:{disabled:""},model:{value:e.addForm.nameUpdater,callback:function(t){e.$set(e.addForm,"nameUpdater",t)},expression:"addForm.nameUpdater"}})],1)],1),e._v(" "),a("div",{staticClass:"el-col el-col-12"},[a("el-form-item",{attrs:{label:"修改时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",disabled:""},model:{value:e.addForm.timeUpdate,callback:function(t){e.$set(e.addForm,"timeUpdate",t)},expression:"addForm.timeUpdate"}})],1)],1)]):e._e(),e._v(" "),a("el-form-item",[3!==e.addType?a("el-button",{attrs:{type:"primary"},on:{click:e.addSubmit}},[e._v(e._s(e.btnName))]):e._e(),e._v(" "),3!==e.addType?a("el-button",{on:{click:e.addCancel}},[e._v("取消")]):e._e(),e._v(" "),3===e.addType?a("el-button",{on:{click:e.addCancel}},[e._v("关闭")]):e._e()],1)],2)],1)],1)},staticRenderFns:[]};var h=a("/Xao")(m,u,!1,function(e){a("OsqV")},"data-v-3502d213",null);t.default=h.exports}});